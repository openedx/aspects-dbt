unit_tests:
  - name: test_fact_enrollments
    model: fact_enrollments
    config:
      tags: 'ci'
    given:
      - input: ref('enrollment_events')
        format: sql
        fixture: enrollment_events
      - input: ref('course_names')
        format: csv
        fixture: course_names
      - input: ref('dim_user_pii')
        format: sql
        fixture: dim_user_pii
    expect:
      format: sql
      fixture: enrollment_events_expected


  - name: test_fact_grades
    model: fact_grades
    config:
      tags: 'ci'
    given:
      - input: ref('grading_events')
        format: sql
        fixture: grading_events
      - input: ref('course_block_names')
        format: sql
        fixture: course_block_names
      - input: ref('dim_user_pii')
        format: sql
        fixture: dim_user_pii
      - input: ref('course_names')
        format: csv
        fixture: course_names
    expect:
      format: sql
      fixture: fact_grades_expected