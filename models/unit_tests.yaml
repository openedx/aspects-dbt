unit_tests:
  - name: test_fact_enrollments
    model: fact_enrollments

    config:
      tags: 'ci'

    given:
      - input: ref('enrollment_events')
        format: csv
        fixture: enrollment_events_input
      - input: ref('course_names')
        format: sql
        rows: |
          select * from event_sink.course_names
      - input: ref('dim_user_pii')
        format: sql
        rows: |
          select * from reporting.dim_user_pii

    expect:
      format: csv
      fixture: enrollment_events_expected
