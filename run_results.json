{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-05-23T20:15:14.096275Z", "invocation_id": "1d17412d-de69-470c-be96-1c6ef8a374a0", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.240034Z", "completed_at": "2024-05-23T20:15:13.251891Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.253533Z", "completed_at": "2024-05-23T20:15:13.253546Z"}], "thread_id": "Thread-1", "execution_time": 0.016257047653198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.course_block_names", "compiled": true, "compiled_code": "\n\nwith\n    most_recent_course_blocks as (\n        select\n            location,\n            display_name,\n            toString(section)\n            || ':'\n            || toString(subsection)\n            || ':'\n            || toString(unit)\n            || ' - '\n            || display_name as display_name_with_location,\n            JSONExtractInt(xblock_data_json, 'section') as section,\n            JSONExtractInt(xblock_data_json, 'subsection') as subsection,\n            JSONExtractInt(xblock_data_json, 'unit') as unit,\n            JSONExtractBool(xblock_data_json, 'graded') as graded,\n            `order` as course_order,\n            course_key,\n            dump_id,\n            time_last_dumped,\n            row_number() over (\n                partition by location order by time_last_dumped desc\n            ) as rn\n        from `event_sink`.`course_blocks`\n    )\nselect\n    location,\n    display_name as block_name,\n    course_key,\n    graded,\n    course_order,\n    display_name_with_location\nfrom most_recent_course_blocks\nwhere rn = 1", "relation_name": "`xapi`.`course_block_names`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.258034Z", "completed_at": "2024-05-23T20:15:13.264429Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.266040Z", "completed_at": "2024-05-23T20:15:13.266047Z"}], "thread_id": "Thread-1", "execution_time": 0.01076817512512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.course_names", "compiled": true, "compiled_code": "\n\nwith\n    most_recent_overviews as (\n        select org, course_key, max(modified) as last_modified\n        from `event_sink`.`course_overviews`\n        group by org, course_key\n    )\nselect course_key, display_name, splitByString('+', course_key)[-1] as course_run, org\nfrom `event_sink`.`course_overviews` co\ninner join\n    most_recent_overviews mro\n    on co.org = mro.org\n    and co.course_key = mro.course_key\n    and co.modified = mro.last_modified", "relation_name": "`xapi`.`course_names`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.270522Z", "completed_at": "2024-05-23T20:15:13.276867Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.278470Z", "completed_at": "2024-05-23T20:15:13.278476Z"}], "thread_id": "Thread-1", "execution_time": 0.010790109634399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.user_pii", "compiled": true, "compiled_code": "\n\nwith\n    most_recent_user_profile as (\n        select\n            user_id,\n            name,\n            email,\n            ROW_NUMBER() over (\n                partition by user_id order by (id, time_last_dumped) DESC\n            ) as rn\n        from `event_sink`.`user_profile`\n    )\nselect mrup.user_id as user_id, external_user_id, username, name, email\nfrom `event_sink`.`external_id` ex\nleft outer join most_recent_user_profile mrup on mrup.user_id = ex.user_id\nwhere mrup.rn = 1", "relation_name": "`xapi`.`user_pii`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.283099Z", "completed_at": "2024-05-23T20:15:13.289803Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.291389Z", "completed_at": "2024-05-23T20:15:13.291396Z"}], "thread_id": "Thread-1", "execution_time": 0.011241436004638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.xapi_events_all_parsed", "compiled": true, "compiled_code": "\n\nselect\n    event_id as event_id,\n    JSON_VALUE(event::String, '$.verb.id') as verb_id,\n    COALESCE(\n        NULLIF(JSON_VALUE(event::String, '$.actor.account.name'), ''),\n        NULLIF(JSON_VALUE(event::String, '$.actor.mbox'), ''),\n        JSON_VALUE(event::String, '$.actor.mbox_sha1sum')\n    ) as actor_id,\n    JSON_VALUE(event::String, '$.object.id') as object_id,\n    -- If the contextActivities parent is a course, use that. It can be a \"course\"\n    -- type, or a \"cmi.interaction\" type for multiple question problem submissions.\n    -- Otherwise use the object id for the course id.\n    multiIf(\n        -- If the contextActivities parent is a course, use that\n        JSON_VALUE(\n            event::String, '$.context.contextActivities.parent[0].definition.type'\n        )\n        = 'http://adlnet.gov/expapi/activities/course',\n        JSON_VALUE(event::String, '$.context.contextActivities.parent[0].id'),\n        -- Else if the contextActivities parent is a GroupActivity, it's a multi\n        -- question problem and we use the grouping id\n        JSON_VALUE(event::String, '$.context.contextActivities.parent[0].objectType')\n        in ('Activity', 'GroupActivity'),\n        JSON_VALUE(event::String, '$.context.contextActivities.grouping[0].id'),\n        -- Otherwise use the object id\n        JSON_VALUE(event::String, '$.object.id')\n    ) as course_id,\n    coalesce(\n        get_org_from_course_url(course_id), get_org_from_ccx_course_url(course_id), ''\n    ) as org,\n    emission_time as emission_time,\n    event::String as event\nfrom `xapi`.`xapi_events_all`", "relation_name": "`xapi`.`xapi_events_all_parsed`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.296291Z", "completed_at": "2024-05-23T20:15:13.301119Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.302757Z", "completed_at": "2024-05-23T20:15:13.302764Z"}], "thread_id": "Thread-1", "execution_time": 0.009408235549926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.a_tag", "compiled": true, "compiled_code": "select\n    'http://local.edly.io/xblock/block-v1:OpenedX+DemoX+DemoCourse+type@video+block@d5a54ce52f464acfa7a83ae155712cc3' as object_id,\n    'The Purpose, Power and Reach of the Open edX\u00ae Platform' as video_name,\n    \n    concat(\n        '<a href=\"', object_id, '\" target=\"_blank\">', video_name, '</a>'\n    )\n as object_a_tag\nfrom\n    system.numbers\nwhere object_a_tag != '<a href=\"http://local.edly.io/xblock/block-v1:OpenedX+DemoX+DemoCourse+type@video+block@d5a54ce52f464acfa7a83ae155712cc3\" target=\"_blank\">The Purpose, Power and Reach of the Open edX\u00ae Platform</a>'", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.307191Z", "completed_at": "2024-05-23T20:15:13.311528Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.313154Z", "completed_at": "2024-05-23T20:15:13.313161Z"}], "thread_id": "Thread-1", "execution_time": 0.008665084838867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.get_problem_id", "compiled": true, "compiled_code": "select\n    'http://local.edly.io:8000/xblock/block-v1:edunext+demo+demo+ccx+type@problem+block@3c1646f7133a4c5fb4557d649e22c251'\n    as object_id\nfrom system.one\nwhere\n    \n    regexpExtract(\n        object_id, 'xblock/([\\w\\d-\\+:@]*@problem\\+block@[\\w\\d][^_]*)(_\\d_\\d)?', 1\n    )\n\n    != 'block-v1:edunext+demo+demo+ccx+type@problem+block@3c1646f7133a4c5fb4557d649e22c251'", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.317626Z", "completed_at": "2024-05-23T20:15:13.321285Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.322860Z", "completed_at": "2024-05-23T20:15:13.322867Z"}], "thread_id": "Thread-1", "execution_time": 0.008003711700439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.get_problem_id_with_ccx", "compiled": true, "compiled_code": "select\n    'http://local.edly.io:8000/xblock/ccx-block-v1:edunext+demo+demo+ccx@1+type@problem+block@3c1646f7133a4c5fb4557d649e22c251'\n    as object_id\nfrom system.one\nwhere\n    \n    regexpExtract(\n        object_id, 'xblock/([\\w\\d-\\+:@]*@problem\\+block@[\\w\\d][^_]*)(_\\d_\\d)?', 1\n    )\n\n    != 'ccx-block-v1:edunext+demo+demo+ccx@1+type@problem+block@3c1646f7133a4c5fb4557d649e22c251'", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.327347Z", "completed_at": "2024-05-23T20:15:13.334118Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.335683Z", "completed_at": "2024-05-23T20:15:13.335690Z"}], "thread_id": "Thread-1", "execution_time": 0.011059284210205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.dim_course_blocks", "compiled": true, "compiled_code": "select\n    courses.org as org,\n    courses.course_key as course_key,\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    blocks.location as block_id,\n    blocks.block_name as block_name,\n    \n    concat(\n        splitByString(\n            ':', splitByString(' - ', blocks.display_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n    \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', blocks.display_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n    as subsection_number,\n    splitByString(' - ', blocks.display_name_with_location)[1] as hierarchy_location,\n    blocks.display_name_with_location as display_name_with_location,\n    course_order,\n    graded,\n    case\n        when block_id like '%@chapter+block@%'\n        then 'section'\n        when block_id like '%@sequential+block@%'\n        then 'subsection'\n        when block_id like '%@vertical+block@%'\n        then 'unit'\n        else regexpExtract(block_id, '@([^+]+)\\+block@', 1)\n    end as block_type\nfrom `xapi`.`course_block_names` blocks\njoin\n    `xapi`.`course_names` courses on blocks.course_key = courses.course_key\n    settings join_algorithm = 'direct'", "relation_name": "`xapi`.`dim_course_blocks`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.340327Z", "completed_at": "2024-05-23T20:15:13.343981Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.345583Z", "completed_at": "2024-05-23T20:15:13.345590Z"}], "thread_id": "Thread-1", "execution_time": 0.008090972900390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.dim_user_pii", "compiled": true, "compiled_code": "select external_user_id, username, name, email from `xapi`.`user_pii` user_pii", "relation_name": "`xapi`.`dim_user_pii`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.350026Z", "completed_at": "2024-05-23T20:15:13.354998Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.356562Z", "completed_at": "2024-05-23T20:15:13.356569Z"}], "thread_id": "Thread-1", "execution_time": 0.009365558624267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.completion_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    CAST(emission_time, 'DateTime') as emission_time,\n    actor_id,\n    object_id,\n    splitByString('/', course_id)[-1] as course_key,\n    org,\n    verb_id,\n    JSON_VALUE(\n        event,\n        '$.result.extensions.\"https://w3id.org/xapi/cmi5/result/extensions/progress\"'\n    ) as progress_percent\nfrom `xapi`.`xapi_events_all_parsed`\nwhere verb_id = 'http://adlnet.gov/expapi/verbs/progressed'", "relation_name": "`xapi`.`completion_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.361144Z", "completed_at": "2024-05-23T20:15:13.366074Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.367681Z", "completed_at": "2024-05-23T20:15:13.367691Z"}], "thread_id": "Thread-1", "execution_time": 0.00944375991821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.enrollment_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    cast(emission_time as DateTime) as emission_time,\n    actor_id,\n    object_id,\n    splitByString('/', course_id)[-1] as course_key,\n    org,\n    verb_id,\n    JSON_VALUE(\n        event,\n        '$.object.definition.extensions.\"https://w3id.org/xapi/acrossx/extensions/type\"'\n    ) as enrollment_mode\nfrom `xapi`.`xapi_events_all_parsed`\nwhere\n    verb_id in (\n        'http://adlnet.gov/expapi/verbs/registered',\n        'http://id.tincanapi.com/verb/unregistered'\n    )", "relation_name": "`xapi`.`enrollment_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.372383Z", "completed_at": "2024-05-23T20:15:13.377019Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.378645Z", "completed_at": "2024-05-23T20:15:13.378652Z"}], "thread_id": "Thread-1", "execution_time": 0.009057760238647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_instance_actors", "compiled": true, "compiled_code": "\n\nselect\n    date_trunc('hour', emission_time) as emission_hour,\n    uniqCombinedState(actor_id) as actors_cnt\nfrom `xapi`.`xapi_events_all_parsed`\ngroup by emission_hour", "relation_name": "`xapi`.`fact_instance_actors`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.383200Z", "completed_at": "2024-05-23T20:15:13.387803Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.389427Z", "completed_at": "2024-05-23T20:15:13.389434Z"}], "thread_id": "Thread-1", "execution_time": 0.009002923965454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_instance_courses", "compiled": true, "compiled_code": "\n\nselect\n    date_trunc('hour', emission_time) as emission_hour,\n    uniqCombinedState(course_id) as courses_cnt\nfrom `xapi`.`xapi_events_all_parsed`\ngroup by emission_hour", "relation_name": "`xapi`.`fact_instance_courses`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.393949Z", "completed_at": "2024-05-23T20:15:13.399282Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.400892Z", "completed_at": "2024-05-23T20:15:13.400899Z"}], "thread_id": "Thread-1", "execution_time": 0.009798288345336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_instance_events", "compiled": true, "compiled_code": "\n\nselect\n    date_trunc('hour', emission_time) as emission_hour,\n    uniqCombinedState(event_id) as events_cnt\nfrom `xapi`.`xapi_events_all_parsed`\ngroup by emission_hour", "relation_name": "`xapi`.`fact_instance_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.405466Z", "completed_at": "2024-05-23T20:15:13.410404Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.411960Z", "completed_at": "2024-05-23T20:15:13.411966Z"}], "thread_id": "Thread-1", "execution_time": 0.00923609733581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.forum_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    CAST(emission_time, 'DateTime') as emission_time,\n    org,\n    splitByString('/', course_id)[-1] as course_key,\n    object_id,\n    actor_id,\n    verb_id\nfrom `xapi`.`xapi_events_all_parsed`\nwhere\n    JSON_VALUE(event, '$.object.definition.type')\n    = 'http://id.tincanapi.com/activitytype/discussion'", "relation_name": "`xapi`.`forum_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.416592Z", "completed_at": "2024-05-23T20:15:13.421580Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.423211Z", "completed_at": "2024-05-23T20:15:13.423218Z"}], "thread_id": "Thread-1", "execution_time": 0.009376764297485352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.grading_events", "compiled": true, "compiled_code": "\n\n\nselect\n    event_id,\n    CAST(emission_time, 'DateTime') as emission_time,\n    actor_id,\n    object_id,\n    splitByString('/', course_id)[-1] as course_key,\n    org,\n    verb_id,\n    JSONExtractFloat(event, 'result', 'score', 'scaled') as scaled_score\nfrom `xapi`.`xapi_events_all_parsed`\nwhere\n    verb_id in (\n        'http://id.tincanapi.com/verb/earned',\n        'https://w3id.org/xapi/acrossx/verbs/evaluated'\n    )\n    or (\n        verb_id in (\n            'http://adlnet.gov/expapi/verbs/passed',\n            'http://adlnet.gov/expapi/verbs/failed'\n        )\n        and JSON_VALUE(event::String, '$.object.definition.type')\n        = 'http://adlnet.gov/expapi/activities/course'\n    )", "relation_name": "`xapi`.`grading_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.427815Z", "completed_at": "2024-05-23T20:15:13.432732Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.434986Z", "completed_at": "2024-05-23T20:15:13.434994Z"}], "thread_id": "Thread-1", "execution_time": 0.010548114776611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.navigation_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    cast(emission_time as DateTime) as emission_time,\n    actor_id,\n    splitByString('/xblock/', object_id)[-1] as block_id,\n    splitByString('/', course_id)[-1] as course_key,\n    org,\n    verb_id,\n    JSONExtractString(event, 'object', 'definition', 'type') as object_type,\n    -- clicking a link and selecting a module outline have no starting-position field\n    if(\n        object_type in (\n            'http://adlnet.gov/expapi/activities/link',\n            'http://adlnet.gov/expapi/activities/module'\n        ),\n        0,\n        JSONExtractInt(\n            event,\n            'context',\n            'extensions',\n            'http://id.tincanapi.com/extension/starting-position'\n        )\n    ) as starting_position,\n    JSONExtractString(\n        event, 'context', 'extensions', 'http://id.tincanapi.com/extension/ending-point'\n    ) as ending_point\nfrom `xapi`.`xapi_events_all_parsed`\nwhere verb_id in ('https://w3id.org/xapi/dod-isd/verbs/navigated')", "relation_name": "`xapi`.`navigation_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.441025Z", "completed_at": "2024-05-23T20:15:13.446341Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.447920Z", "completed_at": "2024-05-23T20:15:13.447926Z"}], "thread_id": "Thread-1", "execution_time": 0.009781599044799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.problem_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    cast(emission_time as DateTime) as emission_time,\n    actor_id,\n    object_id,\n    splitByString('/', course_id)[-1] as course_key,\n    org,\n    verb_id,\n    JSON_VALUE(event, '$.result.response') as responses,\n    JSON_VALUE(event, '$.result.score.scaled') as scaled_score,\n    if(\n        verb_id = 'https://w3id.org/xapi/acrossx/verbs/evaluated',\n        cast(JSON_VALUE(event, '$.result.success') as Bool),\n        false\n    ) as success,\n    JSON_VALUE(event, '$.object.definition.interactionType') as interaction_type,\n    if(\n        verb_id = 'https://w3id.org/xapi/acrossx/verbs/evaluated',\n        cast(\n            JSON_VALUE(\n                event,\n                '$.object.definition.extensions.\"http://id.tincanapi.com/extension/attempt-id\"'\n            ) as Int16\n        ),\n        0\n    ) as attempts,\n    \n    regexpExtract(\n        object_id, 'xblock/([\\w\\d-\\+:@]*@problem\\+block@[\\w\\d][^_]*)(_\\d_\\d)?', 1\n    )\n as problem_id\nfrom `xapi`.`xapi_events_all_parsed`\nwhere\n    verb_id in (\n        'https://w3id.org/xapi/acrossx/verbs/evaluated',\n        'http://adlnet.gov/expapi/verbs/passed',\n        'http://adlnet.gov/expapi/verbs/asked'\n    )", "relation_name": "`xapi`.`problem_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.452583Z", "completed_at": "2024-05-23T20:15:13.457678Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.459245Z", "completed_at": "2024-05-23T20:15:13.459252Z"}], "thread_id": "Thread-1", "execution_time": 0.009504079818725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.video_playback_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    CAST(emission_time, 'DateTime') as emission_time,\n    actor_id,\n    object_id,\n    splitByString('/', course_id)[-1] as course_key,\n    org,\n    verb_id,\n    ceil(\n        CAST(\n            coalesce(\n                nullIf(\n                    JSON_VALUE(\n                        event,\n                        '$.result.extensions.\"https://w3id.org/xapi/video/extensions/time\"'\n                    ),\n                    ''\n                ),\n                nullIf(\n                    JSON_VALUE(\n                        event,\n                        '$.result.extensions.\"https://w3id.org/xapi/video/extensions/time-from\"'\n                    ),\n                    ''\n                ),\n                '0.0'\n            ),\n            'Decimal32(2)'\n        )\n    ) as video_position,\n    JSONExtractInt(\n        event, 'context', 'extensions', 'https://w3id.org/xapi/video/extensions/length'\n    ) as video_duration\nfrom `xapi`.`xapi_events_all_parsed`\nwhere\n    (\n        verb_id in (\n            'http://adlnet.gov/expapi/verbs/completed',\n            'http://adlnet.gov/expapi/verbs/initialized',\n            'http://adlnet.gov/expapi/verbs/terminated',\n            'https://w3id.org/xapi/video/verbs/paused',\n            'https://w3id.org/xapi/video/verbs/played',\n            'https://w3id.org/xapi/video/verbs/seeked'\n        )\n    )\n    and (object_id like '%video+block%')", "relation_name": "`xapi`.`video_playback_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.463767Z", "completed_at": "2024-05-23T20:15:13.469546Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.471153Z", "completed_at": "2024-05-23T20:15:13.471160Z"}], "thread_id": "Thread-1", "execution_time": 0.0101165771484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.video_transcript_events", "compiled": true, "compiled_code": "\n\nselect\n    event_id,\n    CAST(emission_time, 'DateTime') as emission_time,\n    org,\n    splitByString('/', course_id)[-1] as course_key,\n    splitByString('/xblock/', object_id)[2] as video_id,\n    actor_id,\n    JSONExtractBool(\n        event,\n        'result',\n        'extensions',\n        'https://w3id.org/xapi/video/extensions/cc-enabled'\n    ) as cc_enabled\nfrom `xapi`.`xapi_events_all_parsed`\nwhere\n    verb_id in ('http://adlnet.gov/expapi/verbs/interacted')\n    and JSONHas(\n        event,\n        'result',\n        'extensions',\n        'https://w3id.org/xapi/video/extensions/cc-enabled'\n    )", "relation_name": "`xapi`.`video_transcript_events`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.475698Z", "completed_at": "2024-05-23T20:15:13.479892Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.481528Z", "completed_at": "2024-05-23T20:15:13.481534Z"}], "thread_id": "Thread-1", "execution_time": 0.00859975814819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.dim_course_blocks_extended", "compiled": true, "compiled_code": "select\n    blocks.org as org,\n    blocks.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    blocks.block_id as block_id,\n    blocks.block_name as block_name,\n    blocks.section_number as section_number,\n    blocks.subsection_number as subsection_number,\n    blocks.hierarchy_location as hierarchy_location,\n    blocks.display_name_with_location as display_name_with_location,\n    blocks.graded as graded,\n    blocks.course_order as course_order,\n    blocks.block_type as block_type,\n    section_blocks.display_name_with_location as section_with_name,\n    subsection_blocks.display_name_with_location as subsection_with_name\nfrom `xapi`.`dim_course_blocks` blocks\nleft join\n    `xapi`.`dim_course_blocks` section_blocks\n    on (\n        blocks.section_number = section_blocks.hierarchy_location\n        and blocks.org = section_blocks.org\n        and blocks.course_key = section_blocks.course_key\n        and section_blocks.block_id like '%@chapter+block@%'\n    )\nleft join\n    `xapi`.`dim_course_blocks` subsection_blocks\n    on (\n        blocks.subsection_number = subsection_blocks.hierarchy_location\n        and blocks.org = subsection_blocks.org\n        and blocks.course_key = subsection_blocks.course_key\n        and subsection_blocks.block_id like '%@sequential+block@%'\n    )", "relation_name": "`xapi`.`dim_course_blocks_extended`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.486142Z", "completed_at": "2024-05-23T20:15:13.490277Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.491879Z", "completed_at": "2024-05-23T20:15:13.491886Z"}], "thread_id": "Thread-1", "execution_time": 0.00856924057006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.int_pages_per_subsection", "compiled": true, "compiled_code": "with\n    pages_per_subsection as (\n        select\n            org,\n            course_key,\n            section_number,\n            subsection_number,\n            course_order,\n            count(*) as page_count\n        from `xapi`.`dim_course_blocks`\n        where block_id like '%@vertical+block@%'\n        group by org, course_key, section_number, subsection_number, course_order\n    )\n\nselect\n    pps.org as org,\n    pps.course_key as course_key,\n    pps.section_number as section_number,\n    section_blocks.display_name_with_location as section_with_name,\n    pps.subsection_number as subsection_number,\n    subsection_blocks.display_name_with_location as subsection_with_name,\n    pps.course_order as course_order,\n    pps.page_count as page_count\nfrom pages_per_subsection pps\nleft join\n    `xapi`.`dim_course_blocks` section_blocks\n    on (\n        pps.section_number = section_blocks.hierarchy_location\n        and pps.org = section_blocks.org\n        and pps.course_key = section_blocks.course_key\n        and section_blocks.block_id like '%@chapter+block@%'\n    )\nleft join\n    `xapi`.`dim_course_blocks` subsection_blocks\n    on (\n        pps.subsection_number = subsection_blocks.hierarchy_location\n        and pps.org = subsection_blocks.org\n        and pps.course_key = subsection_blocks.course_key\n        and subsection_blocks.block_id like '%@sequential+block@%'\n    )", "relation_name": "`xapi`.`int_pages_per_subsection`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.496434Z", "completed_at": "2024-05-23T20:15:13.501645Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.503205Z", "completed_at": "2024-05-23T20:15:13.503212Z"}], "thread_id": "Thread-1", "execution_time": 0.009565353393554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.int_problems_per_subsection", "compiled": true, "compiled_code": "select * from (\n    with\n        items_per_subsection as (\n            select\n                org,\n                course_key,\n                section_number,\n                subsection_number,\n                course_order,\n                graded,\n                count(*) as item_count\n            from `xapi`.`dim_course_blocks`\n            where block_id like '%@problem+block@%'\n            group by\n                org, course_key, section_number, subsection_number, course_order, graded\n        )\n\n    select\n        ips.org as org,\n        ips.course_key as course_key,\n        ips.section_number as section_number,\n        section_blocks.display_name_with_location as section_with_name,\n        ips.subsection_number as subsection_number,\n        subsection_blocks.display_name_with_location as subsection_with_name,\n        ips.course_order as course_order,\n        ips.graded as graded,\n        ips.item_count as item_count,\n        subsection_blocks.block_id as subsection_block_id,\n        section_blocks.block_id as section_block_id\n    from items_per_subsection ips\n    left join\n        `xapi`.`dim_course_blocks` section_blocks\n        on (\n            ips.section_number = section_blocks.hierarchy_location\n            and ips.org = section_blocks.org\n            and ips.course_key = section_blocks.course_key\n            and section_blocks.block_id like '%@chapter+block@%'\n        )\n    left join\n        `xapi`.`dim_course_blocks` subsection_blocks\n        on (\n            ips.subsection_number = subsection_blocks.hierarchy_location\n            and ips.org = subsection_blocks.org\n            and ips.course_key = subsection_blocks.course_key\n            and subsection_blocks.block_id like '%@sequential+block@%'\n        )\n)", "relation_name": "`xapi`.`int_problems_per_subsection`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.507825Z", "completed_at": "2024-05-23T20:15:13.511618Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.513158Z", "completed_at": "2024-05-23T20:15:13.513165Z"}], "thread_id": "Thread-1", "execution_time": 0.008217811584472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.int_videos_per_subsection", "compiled": true, "compiled_code": "select * from (\n    with\n        items_per_subsection as (\n            select\n                org,\n                course_key,\n                section_number,\n                subsection_number,\n                course_order,\n                graded,\n                count(*) as item_count\n            from `xapi`.`dim_course_blocks`\n            where block_id like '%@video+block@%'\n            group by\n                org, course_key, section_number, subsection_number, course_order, graded\n        )\n\n    select\n        ips.org as org,\n        ips.course_key as course_key,\n        ips.section_number as section_number,\n        section_blocks.display_name_with_location as section_with_name,\n        ips.subsection_number as subsection_number,\n        subsection_blocks.display_name_with_location as subsection_with_name,\n        ips.course_order as course_order,\n        ips.graded as graded,\n        ips.item_count as item_count,\n        subsection_blocks.block_id as subsection_block_id,\n        section_blocks.block_id as section_block_id\n    from items_per_subsection ips\n    left join\n        `xapi`.`dim_course_blocks` section_blocks\n        on (\n            ips.section_number = section_blocks.hierarchy_location\n            and ips.org = section_blocks.org\n            and ips.course_key = section_blocks.course_key\n            and section_blocks.block_id like '%@chapter+block@%'\n        )\n    left join\n        `xapi`.`dim_course_blocks` subsection_blocks\n        on (\n            ips.subsection_number = subsection_blocks.hierarchy_location\n            and ips.org = subsection_blocks.org\n            and ips.course_key = subsection_blocks.course_key\n            and subsection_blocks.block_id like '%@sequential+block@%'\n        )\n)", "relation_name": "`xapi`.`int_videos_per_subsection`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.517712Z", "completed_at": "2024-05-23T20:15:13.522557Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.524178Z", "completed_at": "2024-05-23T20:15:13.524185Z"}], "thread_id": "Thread-1", "execution_time": 0.009143352508544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_completions", "compiled": true, "compiled_code": "with\n    completions as (\n        select\n            emission_time,\n            org,\n            course_key,\n            actor_id,\n            progress_percent,\n            if(\n                object_id like '%/course/%',\n                splitByString('/course/', object_id)[-1],\n                splitByString('/xblock/', object_id)[-1]\n            ) as entity_id,\n            cast(progress_percent as Float) / 100 as scaled_progress\n        from `xapi`.`completion_events`\n    )\n\nselect\n    completions.emission_time as emission_time,\n    completions.org as org,\n    completions.course_key as course_key,\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    completions.entity_id as entity_id,\n    if(blocks.block_name != '', blocks.block_name, courses.course_name) as entity_name,\n    if(\n        blocks.block_name != '', blocks.display_name_with_location, null\n    ) as entity_name_with_location,\n    completions.actor_id as actor_id,\n    cast(completions.scaled_progress as Float) as scaled_progress,\n    case\n        when scaled_progress >= 0.9\n        then '90-100%'\n        when scaled_progress >= 0.8 and scaled_progress < 0.9\n        then '80-89%'\n        when scaled_progress >= 0.7 and scaled_progress < 0.8\n        then '70-79%'\n        when scaled_progress >= 0.6 and scaled_progress < 0.7\n        then '60-69%'\n        when scaled_progress >= 0.5 and scaled_progress < 0.6\n        then '50-59%'\n        when scaled_progress >= 0.4 and scaled_progress < 0.5\n        then '40-49%'\n        when scaled_progress >= 0.3 and scaled_progress < 0.4\n        then '30-39%'\n        when scaled_progress >= 0.2 and scaled_progress < 0.3\n        then '20-29%'\n        when scaled_progress >= 0.1 and scaled_progress < 0.2\n        then '10-19%'\n        else '0-9%'\n    end as completion_bucket,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom completions\njoin `xapi`.`course_names` courses on completions.course_key = courses.course_key\nleft join\n    `xapi`.`course_block_names` blocks on completions.entity_id = blocks.location\nleft outer join\n    `xapi`.`dim_user_pii` users\n    on toUUID(completions.actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_completions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.528644Z", "completed_at": "2024-05-23T20:15:13.534029Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.535597Z", "completed_at": "2024-05-23T20:15:13.535604Z"}], "thread_id": "Thread-1", "execution_time": 0.009635448455810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_enrollment_status", "compiled": true, "compiled_code": "\n\nwith\n    ranked_enrollments as (\n        select\n            emission_time,\n            org,\n            course_key,\n            actor_id,\n            enrollment_mode,\n            splitByString('/', verb_id)[-1] as enrollment_status,\n            row_number() over (\n                partition by org, course_key, actor_id order by emission_time desc\n            ) as rn\n        from `xapi`.`enrollment_events`\n    )\n\nselect org, course_key, actor_id, enrollment_status, enrollment_mode, emission_time\nfrom ranked_enrollments\nwhere rn = 1", "relation_name": "`xapi`.`fact_enrollment_status`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.540093Z", "completed_at": "2024-05-23T20:15:13.544261Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.545842Z", "completed_at": "2024-05-23T20:15:13.545848Z"}], "thread_id": "Thread-1", "execution_time": 0.008504390716552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_enrollments", "compiled": true, "compiled_code": "with\n    enrollments as (\n        select\n            emission_time,\n            org,\n            course_key,\n            actor_id,\n            enrollment_mode,\n            splitByString('/', verb_id)[-1] as enrollment_status\n        from `xapi`.`enrollment_events`\n    )\n\nselect\n    enrollments.emission_time as emission_time,\n    enrollments.org as org,\n    enrollments.course_key as course_key,\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    enrollments.actor_id as actor_id,\n    enrollments.enrollment_mode as enrollment_mode,\n    enrollments.enrollment_status as enrollment_status,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom enrollments\njoin `xapi`.`course_names` courses on enrollments.course_key = courses.course_key\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_enrollments`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.550337Z", "completed_at": "2024-05-23T20:15:13.555131Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.556688Z", "completed_at": "2024-05-23T20:15:13.556694Z"}], "thread_id": "Thread-1", "execution_time": 0.009105920791625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_instance_enrollments", "compiled": true, "compiled_code": "\n\nwith\n    enrollments as (\n        select\n            emission_time,\n            course_key,\n            enrollment_mode,\n            splitByString('/', verb_id)[-1] as enrollment_status\n        from `xapi`.`enrollment_events`\n    )\n\nselect\n    date_trunc('hour', emission_time) as emission_hour,\n    courses.course_name as course_name,\n    enrollments.enrollment_mode as enrollment_mode,\n    enrollments.enrollment_status as enrollment_status,\n    count() as course_enrollment_mode_status_cnt\nfrom enrollments\njoin `xapi`.`course_names` courses on enrollments.course_key = courses.course_key\ngroup by emission_hour, course_name, enrollment_mode, enrollment_status", "relation_name": "`xapi`.`fact_instance_enrollments`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.561506Z", "completed_at": "2024-05-23T20:15:13.565762Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.567321Z", "completed_at": "2024-05-23T20:15:13.567327Z"}], "thread_id": "Thread-1", "execution_time": 0.008876800537109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_forum_interactions", "compiled": true, "compiled_code": "select\n    forum.event_id as event_id,\n    forum.emission_time as emission_time,\n    forum.org as org,\n    forum.course_key as course_key,\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    forum.object_id as object_id,\n    forum.actor_id as actor_id,\n    forum.verb_id as verb_id,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom `xapi`.`forum_events` forum\njoin `xapi`.`course_names` courses on (forum.course_key = courses.course_key)\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_forum_interactions`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.571783Z", "completed_at": "2024-05-23T20:15:13.578527Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.580110Z", "completed_at": "2024-05-23T20:15:13.580117Z"}], "thread_id": "Thread-1", "execution_time": 0.011067390441894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_grades", "compiled": true, "compiled_code": "with\n    grades as (\n        select\n            emission_time,\n            org,\n            course_key,\n            case\n                when object_id like '%/course/%'\n                then 'course'\n                when object_id like '%@sequential+block@%'\n                then 'subsection'\n                when object_id like '%@problem+block@%'\n                then 'problem'\n            end as grade_type,\n            if(\n                grade_type = 'course',\n                splitByString('/course/', object_id)[-1],\n                splitByString('/xblock/', object_id)[-1]\n            ) as entity_id,\n            actor_id,\n            scaled_score\n        from `xapi`.`grading_events`\n        where\n            verb_id in (\n                'http://id.tincanapi.com/verb/earned',\n                'https://w3id.org/xapi/acrossx/verbs/evaluated'\n            )\n    )\n\nselect\n    grades.emission_time as emission_time,\n    grades.org as org,\n    grades.course_key as course_key,\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    grades.entity_id as entity_id,\n    if(blocks.block_name != '', blocks.block_name, courses.course_name) as entity_name,\n    if(\n        blocks.block_name != '', blocks.display_name_with_location, null\n    ) as entity_name_with_location,\n    grades.grade_type as grade_type,\n    grades.actor_id as actor_id,\n    grades.scaled_score as scaled_score,\n    case\n        when scaled_score >= 0.9\n        then '90-100%'\n        when scaled_score >= 0.8 and scaled_score < 0.9\n        then '80-89%'\n        when scaled_score >= 0.7 and scaled_score < 0.8\n        then '70-79%'\n        when scaled_score >= 0.6 and scaled_score < 0.7\n        then '60-69%'\n        when scaled_score >= 0.5 and scaled_score < 0.6\n        then '50-59%'\n        when scaled_score >= 0.4 and scaled_score < 0.5\n        then '40-49%'\n        when scaled_score >= 0.3 and scaled_score < 0.4\n        then '30-39%'\n        when scaled_score >= 0.2 and scaled_score < 0.3\n        then '20-29%'\n        when scaled_score >= 0.1 and scaled_score < 0.2\n        then '10-19%'\n        else '0-9%'\n    end as grade_bucket,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom grades\njoin `xapi`.`course_names` courses on grades.course_key = courses.course_key\nleft join `xapi`.`course_block_names` blocks on grades.entity_id = blocks.location\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_grades`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.584709Z", "completed_at": "2024-05-23T20:15:13.589166Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.590732Z", "completed_at": "2024-05-23T20:15:13.590739Z"}], "thread_id": "Thread-1", "execution_time": 0.008860111236572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_learner_course_grade", "compiled": true, "compiled_code": "\n\nwith\n    ranked_grades as (\n        select\n            emission_time,\n            org,\n            course_key,\n            actor_id,\n            scaled_score as course_grade,\n            row_number() over (\n                partition by org, course_key, actor_id order by emission_time desc\n            ) as rn\n        from `xapi`.`grading_events`\n        where object_id like '%/course/%'\n    )\n\nselect org, course_key, actor_id, course_grade, emission_time\nfrom ranked_grades\nwhere rn = 1", "relation_name": "`xapi`.`fact_learner_course_grade`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.595275Z", "completed_at": "2024-05-23T20:15:13.600588Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.602184Z", "completed_at": "2024-05-23T20:15:13.602191Z"}], "thread_id": "Thread-1", "execution_time": 0.00969696044921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_learner_course_status", "compiled": true, "compiled_code": "\n\nwith\n    ranked_status as (\n        select\n            org,\n            course_key,\n            actor_id,\n            splitByString('/', verb_id)[-1] as approving_state,\n            emission_time,\n            row_number() over (\n                partition by org, course_key, actor_id order by emission_time desc\n            ) as rn\n        from `xapi`.`grading_events`\n        where\n            verb_id in (\n                'http://adlnet.gov/expapi/verbs/passed',\n                'http://adlnet.gov/expapi/verbs/failed'\n            )\n    )\n\nselect org, course_key, actor_id, approving_state, emission_time\nfrom ranked_status\nwhere rn = 1", "relation_name": "`xapi`.`fact_learner_course_status`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.606744Z", "completed_at": "2024-05-23T20:15:13.611683Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.613280Z", "completed_at": "2024-05-23T20:15:13.613287Z"}], "thread_id": "Thread-1", "execution_time": 0.009370565414428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_learner_last_course_visit", "compiled": true, "compiled_code": "\n\nselect org, course_key, actor_id, max(emission_time) as emission_time\nfrom `xapi`.`navigation_events`\ngroup by org, course_key, actor_id", "relation_name": "`xapi`.`fact_learner_last_course_visit`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.617849Z", "completed_at": "2024-05-23T20:15:13.622057Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.623570Z", "completed_at": "2024-05-23T20:15:13.623576Z"}], "thread_id": "Thread-1", "execution_time": 0.008491039276123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_navigation", "compiled": true, "compiled_code": "select\n    navigation.emission_time as emission_time,\n    navigation.org as org,\n    navigation.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    navigation.actor_id as actor_id,\n    navigation.block_id as block_id,\n    blocks.block_name as block_name,\n    blocks.display_name_with_location as block_name_with_location,\n    blocks.course_order as course_order,\n    navigation.object_type as object_type,\n    navigation.starting_position as starting_position,\n    navigation.ending_point as ending_point,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom `xapi`.`navigation_events` navigation\njoin\n    `xapi`.`dim_course_blocks` blocks\n    on (\n        navigation.course_key = blocks.course_key\n        and navigation.block_id = blocks.block_id\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_navigation`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.628235Z", "completed_at": "2024-05-23T20:15:13.632830Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.634430Z", "completed_at": "2024-05-23T20:15:13.634437Z"}], "thread_id": "Thread-1", "execution_time": 0.009042501449584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_problem_responses", "compiled": true, "compiled_code": "with\n    responses as (\n        select\n            emission_time,\n            org,\n            course_key,\n            object_id,\n            problem_id,\n            actor_id,\n            responses,\n            success,\n            attempts,\n            interaction_type\n        from `xapi`.`problem_events`\n        where verb_id = 'https://w3id.org/xapi/acrossx/verbs/evaluated'\n    )\n\nselect\n    responses.emission_time as emission_time,\n    responses.org as org,\n    responses.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    responses.problem_id as problem_id,\n    blocks.block_name as problem_name,\n    blocks.display_name_with_location as problem_name_with_location,\n    \n    concat(\n        '<a href=\"', responses.object_id, '\" target=\"_blank\">', blocks.block_name, '</a>'\n    )\n as problem_link,\n    blocks.graded as graded,\n    course_order as course_order,\n    responses.actor_id as actor_id,\n    responses.responses as responses,\n    responses.success as success,\n    responses.attempts as attempts,\n    responses.interaction_type as interaction_type,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom responses\njoin\n    `xapi`.`dim_course_blocks` blocks\n    on (\n        responses.course_key = blocks.course_key\n        and responses.problem_id = blocks.block_id\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id\ngroup by\n    -- multi-part questions include an extra record for the response to the first\n    -- part of the question. this group by clause eliminates the duplicate record\n    emission_time,\n    org,\n    course_key,\n    course_name,\n    course_run,\n    problem_id,\n    problem_name,\n    problem_name_with_location,\n    problem_link,\n    actor_id,\n    responses,\n    success,\n    attempts,\n    course_order,\n    graded,\n    interaction_type,\n    username,\n    name,\n    email", "relation_name": "`xapi`.`fact_problem_responses`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.639051Z", "completed_at": "2024-05-23T20:15:13.642992Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.644535Z", "completed_at": "2024-05-23T20:15:13.644542Z"}], "thread_id": "Thread-1", "execution_time": 0.008319616317749023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.int_problem_hints", "compiled": true, "compiled_code": "with\n    hints as (\n        select\n            emission_time,\n            org,\n            course_key,\n            problem_id,\n            actor_id,\n            case\n                when object_id like '%/hint%'\n                then 'hint'\n                when object_id like '%/answer%'\n                then 'answer'\n                else 'N/A'\n            end as help_type\n        from `xapi`.`problem_events`\n        where verb_id = 'http://adlnet.gov/expapi/verbs/asked'\n    )\n\nselect\n    hints.emission_time as emission_time,\n    hints.org as org,\n    hints.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    hints.problem_id as problem_id,\n    blocks.block_name as problem_name,\n    blocks.display_name_with_location as problem_name_with_location,\n    blocks.course_order as course_order,\n    hints.actor_id as actor_id,\n    hints.help_type as help_type\nfrom hints\njoin\n    `xapi`.`dim_course_blocks` blocks\n    on (hints.course_key = blocks.course_key and hints.problem_id = blocks.block_id)", "relation_name": "`xapi`.`int_problem_hints`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.649080Z", "completed_at": "2024-05-23T20:15:13.654174Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.655848Z", "completed_at": "2024-05-23T20:15:13.655855Z"}], "thread_id": "Thread-1", "execution_time": 0.009517192840576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.responses", "compiled": true, "compiled_code": "-- select one record per (learner, problem, course, org) tuple\n-- contains either the first successful attempt\n-- or the most recent unsuccessful attempt\n-- find the timestamp of the earliest successful response\n-- this will be used to pick the xAPI event corresponding to that submission\n\n\nwith\n    responses as (\n        select emission_time, org, course_key, object_id, problem_id, actor_id, success\n        from `xapi`.`problem_events`\n        where verb_id = 'https://w3id.org/xapi/acrossx/verbs/evaluated'\n    ),\n    response_status as (\n        select\n            org,\n            course_key,\n            problem_id,\n            actor_id,\n            MIN(case when success then emission_time else NULL end) as first_success_at,\n            MAX(emission_time) as last_attempt_at\n        from responses\n        group by org, course_key, problem_id, actor_id\n    )\nselect\n    org,\n    course_key,\n    problem_id,\n    actor_id,\n    first_success_at,\n    last_attempt_at,\n    coalesce(first_success_at, last_attempt_at) as emission_time\nfrom response_status", "relation_name": "`xapi`.`responses`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.660417Z", "completed_at": "2024-05-23T20:15:13.665554Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.667080Z", "completed_at": "2024-05-23T20:15:13.667086Z"}], "thread_id": "Thread-1", "execution_time": 0.009443521499633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_transcript_usage", "compiled": true, "compiled_code": "select\n    transcripts.emission_time as emission_time,\n    transcripts.org as org,\n    transcripts.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    transcripts.video_id as video_id,\n    blocks.block_name as video_name,\n    blocks.display_name_with_location as video_name_with_location,\n    blocks.course_order as course_order,\n    transcripts.actor_id as actor_id,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom `xapi`.`video_transcript_events` transcripts\njoin\n    `xapi`.`dim_course_blocks` blocks\n    on (\n        transcripts.course_key = blocks.course_key\n        and transcripts.video_id = blocks.block_id\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id\nwhere transcripts.cc_enabled", "relation_name": "`xapi`.`fact_transcript_usage`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.671499Z", "completed_at": "2024-05-23T20:15:13.676518Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.678052Z", "completed_at": "2024-05-23T20:15:13.678058Z"}], "thread_id": "Thread-1", "execution_time": 0.0092010498046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_video_plays", "compiled": true, "compiled_code": "-- model to support number of watches per video\n-- ref:\n-- https://edx.readthedocs.io/projects/edx-insights/en/latest/Reference.html#engagement-computations\nwith\n    plays as (\n        select\n            emission_time,\n            org,\n            course_key,\n            object_id,\n            video_duration,\n            video_position,\n            splitByString('/xblock/', object_id)[-1] as video_id,\n            actor_id\n        from `xapi`.`video_playback_events`\n        where verb_id = 'https://w3id.org/xapi/video/verbs/played'\n    )\n\nselect\n    plays.emission_time as emission_time,\n    plays.org as org,\n    plays.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    plays.video_id as video_id,\n    blocks.block_name as video_name,\n    blocks.display_name_with_location as video_name_with_location,\n    \n    concat(\n        '<a href=\"', plays.object_id, '\" target=\"_blank\">', blocks.block_name, '</a>'\n    )\n as video_link,\n    blocks.graded as graded,\n    plays.video_position as video_position,\n    plays.video_duration as video_duration,\n    case\n        when video_position/video_duration >= 0.9\n        then '90-100%'\n        when video_position/video_duration >= 0.8 and video_position/video_duration < 0.9\n        then '80-89%'\n        when video_position/video_duration >= 0.7 and video_position/video_duration < 0.8\n        then '70-79%'\n        when video_position/video_duration >= 0.6 and video_position/video_duration < 0.7\n        then '60-69%'\n        when video_position/video_duration >= 0.5 and video_position/video_duration < 0.6\n        then '50-59%'\n        when video_position/video_duration >= 0.4 and video_position/video_duration < 0.5\n        then '40-49%'\n        when video_position/video_duration >= 0.3 and video_position/video_duration < 0.4\n        then '30-39%'\n        when video_position/video_duration >= 0.2 and video_position/video_duration < 0.3\n        then '20-29%'\n        when video_position/video_duration >= 0.1 and video_position/video_duration < 0.2\n        then '10-19%'\n        else '0-9%'\n    end as visualization_bucket,\n    plays.actor_id as actor_id,\n    users.username as username,\n    users.name as name,\n    users.email as email,\n    blocks.section_with_name as section_with_name,\n    blocks.subsection_with_name as subsection_with_name,\n    blocks.course_order as course_order\nfrom plays\njoin\n    `xapi`.`dim_course_blocks_extended` blocks\n    on (plays.course_key = blocks.course_key and plays.video_id = blocks.block_id)\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_video_plays`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.682649Z", "completed_at": "2024-05-23T20:15:13.687085Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.688600Z", "completed_at": "2024-05-23T20:15:13.688607Z"}], "thread_id": "Thread-1", "execution_time": 0.008848428726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_watched_video_segments", "compiled": true, "compiled_code": "with\n    video_events as (\n        select\n            emission_time,\n            org,\n            course_key,\n            splitByString('/xblock/', object_id)[-1] as video_id,\n            actor_id,\n            verb_id,\n            video_position,\n            video_duration\n        from `xapi`.`video_playback_events`\n    ),\n    starts as (\n        select *\n        from video_events\n        where verb_id = 'https://w3id.org/xapi/video/verbs/played'\n    ),\n    ends as (\n        select *\n        from video_events\n        where\n            verb_id in (\n                'http://adlnet.gov/expapi/verbs/completed',\n                'https://w3id.org/xapi/video/verbs/seeked',\n                'https://w3id.org/xapi/video/verbs/paused',\n                'http://adlnet.gov/expapi/verbs/terminated'\n            )\n    ),\n    segments as (\n        select\n            starts.org as org,\n            starts.course_key as course_key,\n            starts.video_id as video_id,\n            starts.actor_id,\n            cast(starts.video_position as Int32) as start_position,\n            cast(ends.video_position as Int32) as end_position,\n            starts.emission_time as started_at,\n            ends.emission_time as ended_at,\n            ends.verb_id as end_type,\n            starts.video_duration as video_duration\n        from starts left\n        asof join\n            ends\n            on (\n                starts.org = ends.org\n                and starts.course_key = ends.course_key\n                and starts.video_id = ends.video_id\n                and starts.actor_id = ends.actor_id\n                and starts.emission_time < ends.emission_time\n            )\n    ),\n    enriched_segments as (\n        select\n            segments.org as org,\n            segments.course_key as course_key,\n            blocks.course_name as course_name,\n            blocks.course_run as course_run,\n            blocks.section_with_name as section_with_name,\n            blocks.subsection_with_name as subsection_with_name,\n            blocks.block_name as video_name,\n            blocks.display_name_with_location as video_name_with_location,\n            segments.actor_id as actor_id,\n            segments.started_at as started_at,\n            segments.start_position - (segments.start_position % 5) as start_position,\n            segments.end_position - (segments.end_position % 5) as end_position,\n            segments.video_duration as video_duration\n        from segments\n        join\n            `xapi`.`dim_course_blocks_extended` blocks\n            on (\n                segments.course_key = blocks.course_key\n                and segments.video_id = blocks.block_id\n            )\n    )\n\nselect\n    org,\n    course_key,\n    course_name,\n    course_run,\n    section_with_name,\n    subsection_with_name,\n    video_name,\n    video_name_with_location,\n    actor_id,\n    started_at,\n    arrayJoin(range(start_position, end_position, 5)) as segment_start,\n    video_duration,\n    CONCAT(toString(segment_start), '-', toString(segment_start + 4)) as segment_range,\n    start_position,\n    username,\n    name,\n    email\nfrom enriched_segments\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id\norder by start_position", "relation_name": "`xapi`.`fact_watched_video_segments`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.693180Z", "completed_at": "2024-05-23T20:15:13.699450Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.700967Z", "completed_at": "2024-05-23T20:15:13.700973Z"}], "thread_id": "Thread-1", "execution_time": 0.010596513748168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.section_problem_engagement", "compiled": true, "compiled_code": "\n\nwith\n    responses as (\n        select\n            emission_time,\n            org,\n            course_key,\n            object_id,\n            problem_id,\n            actor_id,\n            responses,\n            success,\n            attempts,\n            interaction_type\n        from `xapi`.`problem_events`\n        where verb_id = 'https://w3id.org/xapi/acrossx/verbs/evaluated'\n    ),\n    fact_problem_responses as (\n        select\n            responses.emission_time as emission_time,\n            responses.org as org,\n            responses.course_key as course_key,\n            blocks.course_name as course_name,\n            responses.problem_id as problem_id,\n            blocks.block_name as problem_name,\n            blocks.display_name_with_location as problem_name_with_location,\n            \n    concat(\n        '<a href=\"', responses.object_id, '\" target=\"_blank\">', blocks.block_name, '</a>'\n    )\n as problem_link,\n            blocks.graded as graded,\n            course_order as course_order,\n            responses.actor_id as actor_id,\n            responses.responses as responses,\n            responses.success as success,\n            responses.attempts as attempts,\n            responses.interaction_type as interaction_type\n        from responses\n        join\n            `xapi`.`dim_course_blocks` blocks\n            on (\n                responses.course_key = blocks.course_key\n                and responses.problem_id = blocks.block_id\n            )\n        group by\n            -- multi-part questions include an extra record for the response to the\n            -- first\n            -- part of the question. this group by clause eliminates the duplicate\n            -- record\n            emission_time,\n            org,\n            course_key,\n            course_name,\n            problem_id,\n            problem_name,\n            problem_name_with_location,\n            problem_link,\n            actor_id,\n            responses,\n            success,\n            attempts,\n            course_order,\n            graded,\n            interaction_type\n    ),\n    attempted_subsection_problems as (\n        select distinct\n            date(emission_time) as attempted_on,\n            org,\n            course_key,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', problem_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', problem_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number,\n            course_order as course_order,\n            graded,\n            actor_id,\n            problem_id\n        from fact_problem_responses\n    ),\n    fact_problem_engagement_per_subsection as (\n        select\n            attempts.org as org,\n            attempts.course_key as course_key,\n            problems.section_with_name as section_with_name,\n            problems.subsection_with_name as subsection_with_name,\n            problems.item_count as item_count,\n            attempts.actor_id as actor_id,\n            attempts.problem_id as problem_id,\n            problems.section_block_id as section_block_id\n        from attempted_subsection_problems attempts\n        join\n            `xapi`.`int_problems_per_subsection` problems\n            on (\n                attempts.org = problems.org\n                and attempts.course_key = problems.course_key\n                and attempts.section_number = problems.section_number\n                and attempts.subsection_number = problems.subsection_number\n            )\n    ),\n    subsection_counts as (\n        select\n            org,\n            course_key,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            item_count,\n            count(distinct problem_id) as problems_attempted,\n            case\n                when problems_attempted = 0\n                then 'No problems attempted yet'\n                when problems_attempted = item_count\n                then 'All problems attempted'\n                else 'At least one problem attempted'\n            end as engagement_level,\n            section_block_id\n        from fact_problem_engagement_per_subsection\n        group by\n            org,\n            course_key,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            item_count,\n            section_block_id\n    ),\n    section_counts as (\n        select\n            org,\n            course_key,\n            actor_id,\n            sum(item_count) as item_count,\n            sum(problems_attempted) as problems_attempted,\n            case\n                when problems_attempted = 0\n                then 'No problems attempted yet'\n                when problems_attempted = item_count\n                then 'All problems attempted'\n                else 'At least one problem attempted'\n            end as engagement_level,\n            section_block_id\n        from subsection_counts\n        group by org, course_key, section_block_id, actor_id\n    )\n\nselect org, course_key, actor_id, section_block_id, engagement_level\nfrom section_counts", "relation_name": "`xapi`.`section_problem_engagement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.705771Z", "completed_at": "2024-05-23T20:15:13.711938Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.713538Z", "completed_at": "2024-05-23T20:15:13.713545Z"}], "thread_id": "Thread-1", "execution_time": 0.01075291633605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.subsection_problem_engagement", "compiled": true, "compiled_code": "\n\nwith\n    responses as (\n        select\n            emission_time,\n            org,\n            course_key,\n            object_id,\n            problem_id,\n            actor_id,\n            responses,\n            success,\n            attempts,\n            interaction_type\n        from `xapi`.`problem_events`\n        where verb_id = 'https://w3id.org/xapi/acrossx/verbs/evaluated'\n    ),\n    fact_problem_responses as (\n        select\n            responses.emission_time as emission_time,\n            responses.org as org,\n            responses.course_key as course_key,\n            blocks.course_name as course_name,\n            responses.problem_id as problem_id,\n            blocks.block_name as problem_name,\n            blocks.display_name_with_location as problem_name_with_location,\n            \n    concat(\n        '<a href=\"', responses.object_id, '\" target=\"_blank\">', blocks.block_name, '</a>'\n    )\n as problem_link,\n            blocks.graded as graded,\n            course_order as course_order,\n            responses.actor_id as actor_id,\n            responses.responses as responses,\n            responses.success as success,\n            responses.attempts as attempts,\n            responses.interaction_type as interaction_type\n        from responses\n        join\n            `xapi`.`dim_course_blocks` blocks\n            on (\n                responses.course_key = blocks.course_key\n                and responses.problem_id = blocks.block_id\n            )\n        group by\n            -- multi-part questions include an extra record for the response to the\n            -- first\n            -- part of the question. this group by clause eliminates the duplicate\n            -- record\n            emission_time,\n            org,\n            course_key,\n            course_name,\n            problem_id,\n            problem_name,\n            problem_name_with_location,\n            problem_link,\n            actor_id,\n            responses,\n            success,\n            attempts,\n            course_order,\n            graded,\n            interaction_type\n    ),\n    attempted_subsection_problems as (\n        select distinct\n            date(emission_time) as attempted_on,\n            org,\n            course_key,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', problem_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', problem_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number,\n            course_order as course_order,\n            graded,\n            actor_id,\n            problem_id\n        from fact_problem_responses\n    ),\n    fact_problem_engagement_per_subsection as (\n        select\n            attempts.org as org,\n            attempts.course_key as course_key,\n            problems.section_with_name as section_with_name,\n            problems.subsection_with_name as subsection_with_name,\n            problems.item_count as item_count,\n            attempts.actor_id as actor_id,\n            attempts.problem_id as problem_id,\n            problems.subsection_block_id as subsection_block_id\n        from attempted_subsection_problems attempts\n        join\n            `xapi`.`int_problems_per_subsection` problems\n            on (\n                attempts.org = problems.org\n                and attempts.course_key = problems.course_key\n                and attempts.section_number = problems.section_number\n                and attempts.subsection_number = problems.subsection_number\n            )\n    ),\n    subsection_counts as (\n        select\n            org,\n            course_key,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            item_count,\n            count(distinct problem_id) as problems_attempted,\n            case\n                when problems_attempted = 0\n                then 'No problems attempted yet'\n                when problems_attempted = item_count\n                then 'All problems attempted'\n                else 'At least one problem attempted'\n            end as engagement_level,\n            subsection_block_id\n        from fact_problem_engagement_per_subsection\n        group by\n            org,\n            course_key,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            item_count,\n            subsection_block_id\n    )\n\nselect org, course_key, actor_id, subsection_block_id, engagement_level\nfrom subsection_counts", "relation_name": "`xapi`.`subsection_problem_engagement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.718319Z", "completed_at": "2024-05-23T20:15:13.732108Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.733747Z", "completed_at": "2024-05-23T20:15:13.733754Z"}], "thread_id": "Thread-1", "execution_time": 0.018309354782104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_enrollment_status_enrollment_status__registered__unregistered.893527c11f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        enrollment_status as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_enrollment_status`\n    group by enrollment_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'registered','unregistered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.738385Z", "completed_at": "2024-05-23T20:15:13.744425Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.746211Z", "completed_at": "2024-05-23T20:15:13.746219Z"}], "thread_id": "Thread-1", "execution_time": 0.010622501373291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_enrollments_enrollment_status__registered__unregistered.f8d10203f4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        enrollment_status as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_enrollments`\n    group by enrollment_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'registered','unregistered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.750888Z", "completed_at": "2024-05-23T20:15:13.756028Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.757593Z", "completed_at": "2024-05-23T20:15:13.757600Z"}], "thread_id": "Thread-1", "execution_time": 0.009509563446044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_instance_enrollments_enrollment_status__registered__unregistered.305ffdf696", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        enrollment_status as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_instance_enrollments`\n    group by enrollment_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'registered','unregistered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.762133Z", "completed_at": "2024-05-23T20:15:13.768588Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.770140Z", "completed_at": "2024-05-23T20:15:13.770147Z"}], "thread_id": "Thread-1", "execution_time": 0.01083230972290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_grades_grade_type__course__subsection__problem.712bd50c2f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        grade_type as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_grades`\n    group by grade_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'course','subsection','problem'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.774754Z", "completed_at": "2024-05-23T20:15:13.779655Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.781180Z", "completed_at": "2024-05-23T20:15:13.781186Z"}], "thread_id": "Thread-1", "execution_time": 0.009273052215576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_student_status", "compiled": true, "compiled_code": "select\n    fes.org as org,\n    fes.course_key as course_key,\n    fes.actor_id as actor_id,\n    courses.course_name as course_name,\n    courses.course_run as course_run,\n    if(empty(approving_state), 'failed', approving_state) as approving_state,\n    enrollment_mode,\n    enrollment_status,\n    course_grade as course_grade,\n    case\n        when course_grade >= 0.9\n        then '90-100%'\n        when course_grade >= 0.8 and course_grade < 0.9\n        then '80-89%'\n        when course_grade >= 0.7 and course_grade < 0.8\n        then '70-79%'\n        when course_grade >= 0.6 and course_grade < 0.7\n        then '60-69%'\n        when course_grade >= 0.5 and course_grade < 0.6\n        then '50-59%'\n        when course_grade >= 0.4 and course_grade < 0.5\n        then '40-49%'\n        when course_grade >= 0.3 and course_grade < 0.4\n        then '30-39%'\n        when course_grade >= 0.2 and course_grade < 0.3\n        then '20-29%'\n        when course_grade >= 0.1 and course_grade < 0.2\n        then '10-19%'\n        else '0-9%'\n    end as grade_bucket,\n    users.username as username,\n    users.name as name,\n    users.email as email,\n    fes.emission_time as enrolled_at\nfrom `xapi`.`fact_enrollment_status` fes\nleft join\n    `xapi`.`fact_learner_course_status` lg\n    on fes.org = lg.org\n    and fes.course_key = lg.course_key\n    and fes.actor_id = lg.actor_id\nleft join\n    `xapi`.`fact_learner_course_grade` ls\n    on fes.org = ls.org\n    and fes.course_key = ls.course_key\n    and fes.actor_id = ls.actor_id\njoin\n    `xapi`.`course_names` courses\n    on fes.org = courses.org\n    and fes.course_key = courses.course_key\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_student_status`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.785973Z", "completed_at": "2024-05-23T20:15:13.791838Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.793396Z", "completed_at": "2024-05-23T20:15:13.793403Z"}], "thread_id": "Thread-1", "execution_time": 0.010415315628051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_learner_course_status_approving_state__passed__failed.f9c0c1b85f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        approving_state as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_learner_course_status`\n    group by approving_state\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'passed','failed'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.798014Z", "completed_at": "2024-05-23T20:15:13.802763Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.804321Z", "completed_at": "2024-05-23T20:15:13.804327Z"}], "thread_id": "Thread-1", "execution_time": 0.009070158004760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_navigation_completion", "compiled": true, "compiled_code": "-- number of learners who've viewed all pages in a section/subsection\nwith\n    visited_subsection_pages as (\n        select distinct\n            date(emission_time) as visited_on,\n            org,\n            course_key,\n            course_name,\n            course_run,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', block_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', block_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number,\n            actor_id,\n            block_id\n        from `xapi`.`fact_navigation`\n    )\n\nselect\n    visits.visited_on as visited_on,\n    visits.org as org,\n    visits.course_key as course_key,\n    visits.course_name as course_name,\n    visits.course_run as course_run,\n    pages.section_with_name as section_with_name,\n    pages.subsection_with_name as subsection_with_name,\n    pages.course_order as course_order,\n    pages.page_count as page_count,\n    visits.actor_id as actor_id,\n    visits.block_id as block_id,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom visited_subsection_pages visits\njoin\n    `xapi`.`int_pages_per_subsection` pages\n    on (\n        visits.org = pages.org\n        and visits.course_key = pages.course_key\n        and visits.section_number = pages.section_number\n        and visits.subsection_number = pages.subsection_number\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_navigation_completion`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.808890Z", "completed_at": "2024-05-23T20:15:13.815075Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.816714Z", "completed_at": "2024-05-23T20:15:13.816720Z"}], "thread_id": "Thread-1", "execution_time": 0.010557889938354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_navigation_dropoff", "compiled": true, "compiled_code": "with\n    blocks as (\n        select\n            org,\n            course_key,\n            display_name_with_location,\n            hierarchy_location,\n            course_order\n        from `xapi`.`dim_course_blocks`\n        where block_id like '%@chapter+block@%' or block_id like '%@sequential+block@%'\n    ),\n    page_views_by_section as (\n        -- section: x:0:0\n        -- take just the first number from the hierarchy location\n        select\n            date(emission_time) as emission_date,\n            org,\n            course_key,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', block_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            actor_id,\n            count(*) as total_views\n        from `xapi`.`fact_navigation`\n        group by emission_date, org, course_key, section_number, actor_id\n    ),\n    page_views_by_subsection as (\n        -- subsection: x:y:0\n        -- take the first two numbers from the hierarchy location\n        select\n            date(emission_time) as emission_date,\n            org,\n            course_key,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', block_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number,\n            actor_id,\n            count(*) as total_views\n        from `xapi`.`fact_navigation`\n        group by emission_date, org, course_key, subsection_number, actor_id\n    ),\n    page_views as (\n        select\n            emission_date,\n            org,\n            course_key,\n            'section' as rollup_name,\n            section_number as hierarchy_location,\n            actor_id,\n            sum(total_views) as total_views\n        from page_views_by_section\n        group by\n            emission_date, org, course_key, rollup_name, hierarchy_location, actor_id\n        union all\n        select\n            emission_date,\n            org,\n            course_key,\n            'subsection' as rollup_name,\n            subsection_number as hierarchy_location,\n            actor_id,\n            sum(total_views) as total_views\n        from page_views_by_subsection\n        group by\n            emission_date, org, course_key, rollup_name, hierarchy_location, actor_id\n    )\n\nselect\n    page_views.emission_date as emission_date,\n    page_views.org as org,\n    page_views.course_key as course_key,\n    page_views.rollup_name as rollup_name,\n    blocks.display_name_with_location as block_name,\n    blocks.course_order as course_order,\n    page_views.actor_id as actor_id,\n    page_views.total_views as total_views,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom page_views\njoin\n    blocks\n    on (\n        page_views.org = blocks.org\n        and page_views.course_key = blocks.course_key\n        and page_views.hierarchy_location = blocks.hierarchy_location\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_navigation_dropoff`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.821315Z", "completed_at": "2024-05-23T20:15:13.825806Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.827381Z", "completed_at": "2024-05-23T20:15:13.827388Z"}], "thread_id": "Thread-1", "execution_time": 0.008801937103271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_problem_engagement_per_subsection", "compiled": true, "compiled_code": "with\n    attempted_subsection_problems as (\n        select distinct\n            date(emission_time) as attempted_on,\n            org,\n            course_key,\n            course_run,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', problem_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', problem_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number,\n            course_order as course_order,\n            graded,\n            actor_id,\n            problem_id,\n            username,\n            name,\n            email\n        from `xapi`.`fact_problem_responses`\n    )\n\nselect\n    attempts.org as org,\n    attempts.course_key as course_key,\n    attempts.course_run as course_run,\n    problems.section_with_name as section_with_name,\n    problems.subsection_with_name as subsection_with_name,\n    problems.item_count as item_count,\n    attempts.actor_id as actor_id,\n    attempts.problem_id as problem_id,\n    attempts.username as username,\n    attempts.name as name,\n    attempts.email as email\nfrom attempted_subsection_problems attempts\njoin\n    `xapi`.`int_problems_per_subsection` problems\n    on (\n        attempts.org = problems.org\n        and attempts.course_key = problems.course_key\n        and attempts.section_number = problems.section_number\n        and attempts.subsection_number = problems.subsection_number\n    )", "relation_name": "`xapi`.`fact_problem_engagement_per_subsection`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.831844Z", "completed_at": "2024-05-23T20:15:13.836773Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.838310Z", "completed_at": "2024-05-23T20:15:13.838316Z"}], "thread_id": "Thread-1", "execution_time": 0.009123086929321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.int_problem_results", "compiled": true, "compiled_code": "-- select one record per (learner, problem, course, org) tuple\n-- contains either the first successful attempt\n-- or the most recent unsuccessful attempt\n-- find the timestamp of the earliest successful response\n-- this will be used to pick the xAPI event corresponding to that submission\nwith\n    successful_responses as (\n        select org, course_key, problem_id, actor_id, first_success_at\n        from `xapi`.`responses`\n        where isNotNull(first_success_at)\n    ),\n    -- for all learners who did not submit a successful response,\n    -- find the timestamp of the most recent unsuccessful response\n    unsuccessful_responses as (\n        select\n            org,\n            course_key,\n            problem_id,\n            actor_id,\n            max(last_attempt_at) as last_attempt_at\n        from `xapi`.`responses`\n        where actor_id not in (select distinct actor_id from successful_responses)\n        group by org, course_key, problem_id, actor_id\n    ),\n    -- combine result sets for successful and unsuccessful problem submissions\n    responses as (\n        select org, course_key, problem_id, actor_id, first_success_at as emission_time\n        from successful_responses\n        union all\n        select org, course_key, problem_id, actor_id, last_attempt_at as emission_time\n        from unsuccessful_responses\n    ),\n    full_responses as (\n        select\n            events.emission_time as emission_time,\n            events.org as org,\n            events.course_key as course_key,\n            events.problem_id as problem_id,\n            events.object_id as object_id,\n            events.actor_id as actor_id,\n            events.responses as responses,\n            events.success as success,\n            events.attempts as attempts,\n            events.interaction_type as interaction_type\n        from `xapi`.`problem_events` events\n        join responses using (org, course_key, problem_id, actor_id, emission_time)\n    )\n\nselect\n    full_responses.emission_time as emission_time,\n    full_responses.org as org,\n    full_responses.course_key as course_key,\n    blocks.course_name as course_name,\n    blocks.course_run as course_run,\n    full_responses.problem_id as problem_id,\n    blocks.block_name as problem_name,\n    blocks.display_name_with_location as problem_name_with_location,\n    blocks.course_order as course_order,\n    \n    concat(\n        '<a href=\"', full_responses.object_id, '\" target=\"_blank\">', blocks.block_name, '</a>'\n    )\n as problem_link,\n    full_responses.actor_id as actor_id,\n    full_responses.responses as responses,\n    full_responses.success as success,\n    full_responses.attempts as attempts,\n    full_responses.interaction_type as interaction_type,\n    blocks.graded\nfrom full_responses\njoin\n    `xapi`.`dim_course_blocks` blocks\n    on (\n        full_responses.course_key = blocks.course_key\n        and full_responses.problem_id = blocks.block_id\n    )", "relation_name": "`xapi`.`int_problem_results`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.842925Z", "completed_at": "2024-05-23T20:15:13.847433Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.848995Z", "completed_at": "2024-05-23T20:15:13.849002Z"}], "thread_id": "Thread-1", "execution_time": 0.008939504623413086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_video_engagement_per_subsection", "compiled": true, "compiled_code": "with\n    viewed_subsection_videos as (\n        select distinct\n            date(emission_time) as viewed_on,\n            org,\n            course_key,\n            course_run,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', video_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', video_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number,\n            graded,\n            actor_id,\n            video_id,\n            username,\n            name,\n            email\n        from `xapi`.`fact_video_plays`\n    )\n\nselect\n    views.viewed_on,\n    views.org,\n    views.course_key,\n    views.course_run,\n    videos.section_with_name,\n    videos.subsection_with_name,\n    videos.course_order,\n    videos.item_count,\n    views.actor_id,\n    views.video_id,\n    views.graded,\n    views.username as username,\n    views.name as name,\n    views.email as email\nfrom viewed_subsection_videos views\njoin\n    `xapi`.`int_videos_per_subsection` videos\n    on (\n        views.org = videos.org\n        and views.course_key = videos.course_key\n        and views.section_number = videos.section_number\n        and views.subsection_number = videos.subsection_number\n    )", "relation_name": "`xapi`.`fact_video_engagement_per_subsection`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.853633Z", "completed_at": "2024-05-23T20:15:13.860043Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.861638Z", "completed_at": "2024-05-23T20:15:13.861647Z"}], "thread_id": "Thread-1", "execution_time": 0.010872125625610352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_section_problem_engagement_engagement_level__No_problems_attempted_yet__All_problems_attempted__At_least_one_problem_attempted.10f2c3b57c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        engagement_level as value_field,\n        count(*) as n_records\n\n    from `xapi`.`section_problem_engagement`\n    group by engagement_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'No problems attempted yet','All problems attempted','At least one problem attempted'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.866315Z", "completed_at": "2024-05-23T20:15:13.870846Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.872349Z", "completed_at": "2024-05-23T20:15:13.872356Z"}], "thread_id": "Thread-1", "execution_time": 0.008921384811401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_problem_engagement", "compiled": true, "compiled_code": "with\n    subsection_engagement as (\n        select\n            org,\n            course_key,\n            'subsection' as content_level,\n            actor_id,\n            subsection_block_id as block_id,\n            engagement_level as section_subsection_problem_engagement\n        from `xapi`.`subsection_problem_engagement`\n    ),\n    section_engagement as (\n        select\n            org,\n            course_key,\n            'section' as content_level,\n            actor_id,\n            section_block_id as block_id,\n            engagement_level as section_subsection_problem_engagement\n        from `xapi`.`section_problem_engagement`\n    ),\n    problem_engagement as (\n        select *\n        from subsection_engagement\n        union all\n        select *\n        from section_engagement\n    )\nselect\n    pe.org as org,\n    pe.course_key as course_key,\n    course_blocks.course_run as course_run,\n    course_blocks.display_name_with_location as section_subsection_name,\n    pe.content_level as content_level,\n    pe.actor_id as actor_id,\n    pe.section_subsection_problem_engagement as section_subsection_problem_engagement,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom problem_engagement pe\njoin\n    `xapi`.`dim_course_blocks` course_blocks\n    on (\n        pe.org = course_blocks.org\n        and pe.course_key = course_blocks.course_key\n        and pe.block_id = course_blocks.block_id\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(pe.actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_problem_engagement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.876960Z", "completed_at": "2024-05-23T20:15:13.882877Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.884468Z", "completed_at": "2024-05-23T20:15:13.884475Z"}], "thread_id": "Thread-1", "execution_time": 0.010389328002929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_subsection_problem_engagement_engagement_level__No_problems_attempted_yet__All_problems_attempted__At_least_one_problem_attempted.65ea3dc0c7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        engagement_level as value_field,\n        count(*) as n_records\n\n    from `xapi`.`subsection_problem_engagement`\n    group by engagement_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'No problems attempted yet','All problems attempted','At least one problem attempted'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.889000Z", "completed_at": "2024-05-23T20:15:13.892997Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.894560Z", "completed_at": "2024-05-23T20:15:13.894566Z"}], "thread_id": "Thread-1", "execution_time": 0.008307695388793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.dim_at_risk_learners", "compiled": true, "compiled_code": "with\n    page_visits as (\n        select org, course_key, actor_id, max(emission_time) as last_visited\n        from `xapi`.`navigation_events`\n        group by org, course_key, actor_id\n    )\n\nselect\n    learners.org as org,\n    learners.course_key as course_key,\n    learners.course_name as course_name,\n    learners.course_run as course_run,\n    learners.actor_id as actor_id,\n    learners.username as username,\n    learners.name as name,\n    learners.email as email,\n    learners.enrollment_mode as enrollment_mode,\n    learners.course_grade as course_grade,\n    learners.enrolled_at as enrolled_at,\n    learners.grade_bucket as grade_bucket,\n    page_visits.last_visited as last_visited\nfrom `xapi`.`fact_student_status` learners\njoin page_visits using (org, course_key, actor_id)\nwhere\n    approving_state = 'failed'\n    and enrollment_status = 'registered'\n    and page_visits.last_visited < subtractDays(now(), 7)", "relation_name": "`xapi`.`dim_at_risk_learners`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.899121Z", "completed_at": "2024-05-23T20:15:13.903254Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.904827Z", "completed_at": "2024-05-23T20:15:13.904834Z"}], "thread_id": "Thread-1", "execution_time": 0.008396148681640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.learner_summary", "compiled": true, "compiled_code": "with\n    latest_emission_time as (\n        select course_key, actor_id, MAX(emission_time) as last_visited\n        from `xapi`.`fact_navigation`\n        group by course_key, actor_id\n    ),\n    enrollment_status as (\n        select course_key, actor_id, MAX(emission_time) as max_emission_time\n        from `xapi`.`fact_enrollment_status`\n        group by course_key, actor_id\n    )\nselect\n    fss.org as org,\n    fss.course_key as course_key,\n    fss.actor_id as actor_id,\n    fss.course_name as course_name,\n    fss.course_run as course_run,\n    fss.approving_state as approving_state,\n    fss.enrollment_mode as enrollment_mode,\n    fss.enrollment_status as enrollment_status,\n    fss.course_grade as course_grade,\n    fss.grade_bucket as grade_bucket,\n    fss.username as username,\n    fss.name as name,\n    fss.email as email,\n    fes.max_emission_time as emission_time,\n    let.last_visited as last_visited\nfrom `xapi`.`fact_student_status` fss\nleft join\n    enrollment_status fes\n    on fss.course_key = fes.course_key\n    and fss.actor_id = fes.actor_id\nleft join\n    latest_emission_time let\n    on fss.course_key = let.course_key\n    and fss.actor_id = let.actor_id", "relation_name": "`xapi`.`learner_summary`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.909485Z", "completed_at": "2024-05-23T20:15:13.914348Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.915900Z", "completed_at": "2024-05-23T20:15:13.915907Z"}], "thread_id": "Thread-1", "execution_time": 0.009282350540161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_student_status_enrollment_status__registered__unregistered.53cae8a0f3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        enrollment_status as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_student_status`\n    group by enrollment_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'registered','unregistered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.920391Z", "completed_at": "2024-05-23T20:15:13.924570Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.926112Z", "completed_at": "2024-05-23T20:15:13.926119Z"}], "thread_id": "Thread-1", "execution_time": 0.008509635925292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_pageview_engagement", "compiled": true, "compiled_code": "with\n    subsection_counts as (\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            page_count,\n            count(distinct block_id) as pages_visited,\n            case\n                when pages_visited = 0\n                then 'No pages viewed yet'\n                when pages_visited = page_count\n                then 'All pages viewed'\n                else 'At least one page viewed'\n            end as engagement_level\n        from `xapi`.`fact_navigation_completion`\n        group by\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            page_count\n    ),\n    section_counts as (\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            '' as subsection_with_name,\n            actor_id,\n            sum(page_count) as page_count,\n            sum(pages_visited) as pages_visited,\n            case\n                when pages_visited = 0\n                then 'No pages viewed yet'\n                when pages_visited = page_count\n                then 'All pages viewed'\n                else 'At least one page viewed'\n            end as engagement_level\n        from subsection_counts\n        group by\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            subsection_with_name,\n            actor_id\n    ),\n    pageview_counts as (\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name as section_with_name,\n            subsection_with_name as subsection_with_name,\n            subsection_with_name as section_subsection_name,\n            'subsection' as content_level,\n            actor_id as actor_id,\n            engagement_level as section_subsection_page_engagement\n        from subsection_counts\n        union all\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name as section_with_name,\n            subsection_with_name as subsection_with_name,\n            section_with_name as section_subsection_name,\n            'section' as content_level,\n            actor_id as actor_id,\n            engagement_level as section_subsection_page_engagement\n        from section_counts\n\n    )\n\nselect\n    pv.org as org,\n    pv.course_key as course_key,\n    pv.course_run as course_run,\n    pv.section_with_name as section_with_name,\n    pv.subsection_with_name as subsection_with_name,\n    pv.section_subsection_name as section_subsection_name,\n    pv.content_level as content_level,\n    pv.actor_id as actor_id,\n    pv.section_subsection_page_engagement as section_subsection_page_engagement,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom pageview_counts pv\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_pageview_engagement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.930726Z", "completed_at": "2024-05-23T20:15:13.936322Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.937938Z", "completed_at": "2024-05-23T20:15:13.937945Z"}], "thread_id": "Thread-1", "execution_time": 0.009959936141967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_navigation_dropoff_rollup_name__section__subsection.8afafb193f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rollup_name as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_navigation_dropoff`\n    group by rollup_name\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'section','subsection'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.942398Z", "completed_at": "2024-05-23T20:15:13.947704Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.949259Z", "completed_at": "2024-05-23T20:15:13.949270Z"}], "thread_id": "Thread-1", "execution_time": 0.00959324836730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_learner_problem_summary", "compiled": true, "compiled_code": "-- summary table for a learner's performance on and interactions with a\n-- particular problem\nwith\n    results_with_hints as (\n        select\n            org,\n            course_key,\n            course_name,\n            course_run,\n            problem_id,\n            problem_name,\n            problem_name_with_location,\n            course_order,\n            actor_id,\n            success,\n            attempts,\n            0 as num_hints_displayed,\n            0 as num_answers_displayed\n        from `xapi`.`int_problem_results`\n        union all\n        select\n            org,\n            course_key,\n            course_name,\n            course_run,\n            problem_id,\n            problem_name,\n            problem_name_with_location,\n            course_order,\n            actor_id,\n            null as success,\n            null as attempts,\n            case help_type when 'hint' then 1 else 0 end as num_hints_displayed,\n            case help_type when 'answer' then 1 else 0 end as num_answers_displayed\n        from `xapi`.`int_problem_hints`\n    )\n\n-- n.b.: there should only be one row per org, course, problem, and actor\n-- in problem_results, so any(success) and any(attempts) should return the\n-- values from that part of the union and not the null values used as\n-- placeholders in the problem_hints part of the union\nselect\n    org,\n    course_key,\n    course_name,\n    course_run,\n    problem_id,\n    problem_name,\n    problem_name_with_location,\n    course_order,\n    actor_id,\n    coalesce(any(success), false) as success,\n    coalesce(any(attempts), 0) as attempts,\n    sum(num_hints_displayed) as num_hints_displayed,\n    sum(num_answers_displayed) as num_answers_displayed,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom results_with_hints\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id\ngroup by\n    org,\n    course_key,\n    course_name,\n    course_run,\n    problem_id,\n    problem_name,\n    problem_name_with_location,\n    course_order,\n    actor_id,\n    username,\n    name,\n    email", "relation_name": "`xapi`.`fact_learner_problem_summary`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.953868Z", "completed_at": "2024-05-23T20:15:13.958618Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.960129Z", "completed_at": "2024-05-23T20:15:13.960135Z"}], "thread_id": "Thread-1", "execution_time": 0.009100914001464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_problem_responses_extended", "compiled": true, "compiled_code": "with\n    problem_results as (\n        select\n            *,\n            \n    concat(\n        splitByString(\n            ':', splitByString(' - ', problem_name_with_location)[1], 1\n        )[1],\n        ':0:0'\n    )\n as section_number,\n            \n    concat(\n        arrayStringConcat(\n            splitByString(\n                ':', splitByString(' - ', problem_name_with_location)[1], 2\n            ),\n            ':'\n        ),\n        ':0'\n    )\n\n            as subsection_number\n        from `xapi`.`int_problem_results`\n    )\nselect\n    results.emission_time as emission_time,\n    results.org as org,\n    results.course_key as course_key,\n    results.course_name as course_name,\n    results.course_run as course_run,\n    problems.section_with_name as section_with_name,\n    problems.subsection_with_name as subsection_with_name,\n    results.problem_id as problem_id,\n    results.problem_name as problem_name,\n    results.problem_name_with_location as problem_name_with_location,\n    results.problem_link as problem_link,\n    results.actor_id as actor_id,\n    results.responses as responses,\n    results.success as success,\n    results.attempts as attempts,\n    results.course_order as course_order,\n    results.graded as graded,\n    results.interaction_type as interaction_type,\n    users.username as username,\n    users.name as name,\n    users.email as email\nfrom problem_results results\njoin\n    `xapi`.`int_problems_per_subsection` problems\n    on (\n        results.org = problems.org\n        and results.course_key = problems.course_key\n        and results.section_number = problems.section_number\n        and results.subsection_number = problems.subsection_number\n    )\nleft outer join\n    `xapi`.`dim_user_pii` users on toUUID(actor_id) = users.external_user_id", "relation_name": "`xapi`.`fact_problem_responses_extended`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.964571Z", "completed_at": "2024-05-23T20:15:13.968180Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.969746Z", "completed_at": "2024-05-23T20:15:13.969752Z"}], "thread_id": "Thread-1", "execution_time": 0.007863759994506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.problem_results_uniqueness", "compiled": true, "compiled_code": "-- problem_results should only have one record for the following\n-- combination of values:\n-- actor_id, problem_id, course_id, org\nselect org, course_key, problem_id, actor_id, responses, count(*) as num_rows\nfrom `xapi`.`int_problem_results`\ngroup by org, course_key, problem_id, actor_id, responses\nhaving num_rows > 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.974142Z", "completed_at": "2024-05-23T20:15:13.978110Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.979655Z", "completed_at": "2024-05-23T20:15:13.979662Z"}], "thread_id": "Thread-1", "execution_time": 0.00820302963256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.aspects.fact_video_engagement", "compiled": true, "compiled_code": "with\n    subsection_counts as (\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            item_count,\n            count(distinct video_id) as videos_viewed,\n            case\n                when videos_viewed = 0\n                then 'No videos viewed yet'\n                when videos_viewed = item_count\n                then 'All videos viewed'\n                else 'At least one video viewed'\n            end as engagement_level,\n            username,\n            name,\n            email\n        from `xapi`.`fact_video_engagement_per_subsection`\n        group by\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            item_count,\n            username,\n            name,\n            email\n    ),\n    section_counts as (\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            '' as subsection_with_name,\n            actor_id,\n            sum(item_count) as item_count,\n            sum(videos_viewed) as videos_viewed,\n            case\n                when videos_viewed = 0\n                then 'No videos viewed yet'\n                when videos_viewed = item_count\n                then 'All videos viewed'\n                else 'At least one video viewed'\n            end as engagement_level,\n            username,\n            name,\n            email\n        from subsection_counts\n        group by\n            org,\n            course_key,\n            course_run,\n            section_with_name,\n            subsection_with_name,\n            actor_id,\n            username,\n            name,\n            email\n    ),\n    all_counts as (\n\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name as section_with_name,\n            subsection_with_name as subsection_with_name,\n            subsection_with_name as section_subsection_name,\n            'subsection' as content_level,\n            actor_id as actor_id,\n            engagement_level as section_subsection_video_engagement,\n            username,\n            name,\n            email\n        from subsection_counts\n        union all\n        select\n            org,\n            course_key,\n            course_run,\n            section_with_name as section_with_name,\n            subsection_with_name as subsection_with_name,\n            section_with_name as section_subsection_name,\n            'section' as content_level,\n            actor_id as actor_id,\n            engagement_level as section_subsection_video_engagement,\n            username,\n            name,\n            email\n        from section_counts\n    )\nselect\n    ac.org as org,\n    ac.course_key as course_key,\n    ac.course_run as course_run,\n    ac.section_with_name as section_with_name,\n    ac.subsection_with_name as subsection_with_name,\n    ac.section_subsection_name as section_subsection_name,\n    ac.content_level as content_level,\n    ac.actor_id as actor_id,\n    ac.section_subsection_video_engagement as section_subsection_video_engagement,\n    ac.username as username,\n    ac.name as name,\n    ac.email as email\nfrom all_counts ac", "relation_name": "`xapi`.`fact_video_engagement`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.984245Z", "completed_at": "2024-05-23T20:15:13.989279Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:13.990821Z", "completed_at": "2024-05-23T20:15:13.990829Z"}], "thread_id": "Thread-1", "execution_time": 0.009462356567382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_problem_engagement_section_subsection_problem_engagement__No_problems_attempted_yet__All_problems_attempted__At_least_one_problem_attempted.f98e4bc69f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        section_subsection_problem_engagement as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_problem_engagement`\n    group by section_subsection_problem_engagement\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'No problems attempted yet','All problems attempted','At least one problem attempted'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:13.995300Z", "completed_at": "2024-05-23T20:15:14.000503Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.002319Z", "completed_at": "2024-05-23T20:15:14.002327Z"}], "thread_id": "Thread-1", "execution_time": 0.010211467742919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_learner_summary_enrollment_status__registered__unregistered.be87359ff8", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        enrollment_status as value_field,\n        count(*) as n_records\n\n    from `xapi`.`learner_summary`\n    group by enrollment_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'registered','unregistered'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:14.009840Z", "completed_at": "2024-05-23T20:15:14.018231Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.020657Z", "completed_at": "2024-05-23T20:15:14.020668Z"}], "thread_id": "Thread-1", "execution_time": 0.015485525131225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_pageview_engagement_content_level__section__subsection.dd9e9af3ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        content_level as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_pageview_engagement`\n    group by content_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'section','subsection'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:14.027847Z", "completed_at": "2024-05-23T20:15:14.033781Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.036113Z", "completed_at": "2024-05-23T20:15:14.036122Z"}], "thread_id": "Thread-1", "execution_time": 0.012267112731933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.learner_problem_summary_uniqueness", "compiled": true, "compiled_code": "select org, course_key, problem_id, actor_id, count(*) as num_rows\nfrom `xapi`.`fact_learner_problem_summary`\ngroup by org, course_key, problem_id, actor_id\nhaving num_rows > 1", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:14.040720Z", "completed_at": "2024-05-23T20:15:14.050469Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.052324Z", "completed_at": "2024-05-23T20:15:14.052331Z"}], "thread_id": "Thread-1", "execution_time": 0.014505147933959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.not_null_fact_learner_problem_summary_attempts.817beed32b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect attempts\nfrom `xapi`.`fact_learner_problem_summary`\nwhere attempts is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:14.057105Z", "completed_at": "2024-05-23T20:15:14.061969Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.064027Z", "completed_at": "2024-05-23T20:15:14.064038Z"}], "thread_id": "Thread-1", "execution_time": 0.009984731674194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.not_null_fact_learner_problem_summary_success.76b52cb2da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect success\nfrom `xapi`.`fact_learner_problem_summary`\nwhere success is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:14.068979Z", "completed_at": "2024-05-23T20:15:14.075818Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.077538Z", "completed_at": "2024-05-23T20:15:14.077547Z"}], "thread_id": "Thread-1", "execution_time": 0.011309623718261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_video_engagement_content_level__section__subsection.636c5e7005", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        content_level as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_video_engagement`\n    group by content_level\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'section','subsection'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-05-23T20:15:14.082275Z", "completed_at": "2024-05-23T20:15:14.090002Z"}, {"name": "execute", "started_at": "2024-05-23T20:15:14.091525Z", "completed_at": "2024-05-23T20:15:14.091532Z"}], "thread_id": "Thread-1", "execution_time": 0.01209259033203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.aspects.accepted_values_fact_video_engagement_section_subsection_video_engagement__No_videos_viewed_yet__At_least_one_video_viewed__All_videos_viewed.91f6ccbf80", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        section_subsection_video_engagement as value_field,\n        count(*) as n_records\n\n    from `xapi`.`fact_video_engagement`\n    group by section_subsection_video_engagement\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'No videos viewed yet','At least one video viewed','All videos viewed'\n)\n\n\n", "relation_name": null}], "elapsed_time": 0.9523108005523682, "args": {"print": true, "introspect": true, "defer": false, "write_json": true, "printer_width": 80, "cache_selected_only": false, "compile": true, "send_anonymous_usage_stats": true, "empty_catalog": false, "static_parser": true, "use_colors_file": true, "macro_debugging": false, "log_level": "info", "partial_parse_file_diff": true, "version_check": true, "static": false, "select": [], "partial_parse": true, "log_file_max_bytes": 10485760, "log_level_file": "debug", "project_dir": "/home/runner/work/aspects-dbt/aspects-dbt", "use_colors": true, "which": "generate", "exclude": [], "log_path": "/home/runner/work/aspects-dbt/aspects-dbt/logs", "favor_state": false, "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "enable_legacy_logger": false, "quiet": false, "log_format_file": "debug", "profiles_dir": "./.github/", "show_resource_report": false, "log_format": "default", "strict_mode": false, "invocation_command": "dbt docs generate", "vars": {}, "indirect_selection": "eager"}}